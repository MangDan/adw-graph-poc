{"ast":null,"code":"import \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.string.includes.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nexport default {\n  name: \"Graph\",\n  data: function data() {\n    return {\n      container: null,\n      blitzboard: null,\n      config: null,\n      graph: null,\n      inputpg: \"\",\n      dialog: false,\n      graphData: null,\n      graphItems: [{\n        text: \"종목\",\n        value: \"G_NH_STOCK\"\n      }, {\n        text: \"제품\",\n        value: \"G_NH_PRODUCT\"\n      }, {\n        text: \"인물\",\n        value: \"G_NH_PEOPLE\"\n      }, {\n        text: \"테마\",\n        value: \"G_NH_THEME\"\n      }, // by iron - 기관 회사 이벤트 추가\n      {\n        text: \"기관\",\n        value: \"G_NH_AGENT\"\n      }, {\n        text: \"회사\",\n        value: \"G_NH_COMPANY\"\n      }, {\n        text: \"이벤트\",\n        value: \"G_NH_EVENT\"\n      }]\n    };\n  },\n  created: function created() {\n    var _this = this;\n\n    this.$EventBus.$on(\"cleanGraph\", function () {\n      _this.blitzboard.setGraph('');\n    });\n    this.$EventBus.$on(\"initGraph\", function (config) {\n      _this.container = document.getElementById(\"blitzboard\");\n      _this.blitzboard = new Blitzboard(_this.container); // no-undef\n\n      _this.config = config; // pg를 통해서 그래프 생성\n\n      _this.blitzboard.setGraph(\"\", false);\n\n      _this.blitzboard.setConfig(_this.config);\n\n      _this.registerClickEventonGraph();\n    });\n    this.$EventBus.$on(\"querySubmit\", function (formData) {\n      console.log(formData);\n      _this.formData = formData;\n      var query = ''; // Graph만\n      // -- by iron query 수정     \n\n      if (_this.formData.searchTerm === '') {\n        query += \"SELECT * FROM MATCH (n1)-[e]-(n2) \";\n        query += \"ON \" + formData.graph + \" \"; //query += \"LIMIT 10\";\n      } else {\n        query += \"SELECT * FROM MATCH (n1)-[e]-(n2) \";\n        query += \"ON \" + formData.graph + \" \"; //query += \"WHERE n1.v_name = '\" + formData.searchTerm + \"' \";\n\n        query += \"WHERE JAVA_REGEXP_LIKE(n1.v_name, '\" + formData.searchTerm + \"') \"; //query += \"LIMIT \" + formData.limit;\n      }\n\n      if (_this.formData.limit !== '') {\n        query += \"LIMIT \" + formData.limit;\n      }\n\n      console.log(query);\n\n      _this.$axios({\n        method: \"get\",\n        url: \"/ui/v1/query?pgql=\" + encodeURI(query),\n        // + \"&graph=\" + this.formData.graph,  -- by iron \n        headers: {\n          \"Content-type\": \"application/json\"\n        },\n        withCredentials: true,\n        cossDomain: true\n      }).then(function (response) {\n        var nodes = [];\n        var edges = [];\n        var result = response.data;\n        result.graph.vertices.forEach(function (elem) {\n          var node = {\n            id: elem._id,\n            labels: elem.l,\n            properties: {}\n          };\n          elem.p.forEach(function (elem_p) {\n            if (elem_p.v) {\n              node.properties[elem_p.n] = [elem_p.v];\n            }\n          });\n          nodes.push(node);\n        });\n        result.graph.edges.forEach(function (elem) {\n          var edge = {\n            id: elem._id,\n            from: elem.s,\n            to: elem.d,\n            labels: elem.l,\n            properties: {}\n          };\n          elem.p.forEach(function (elem_p) {\n            if (elem_p.v) {\n              edge.properties[elem_p.n] = [elem_p.v];\n            }\n          });\n          edges.push(edge);\n        });\n        _this.graphData = {\n          nodes: nodes,\n          edges: edges\n        };\n        console.log(_this.graphData);\n\n        _this.blitzboard.setGraph(_this.graphData, true);\n\n        _this.blitzboard.setConfig(_this.config);\n\n        _this.registerClickEventonGraph();\n      });\n    });\n    this.$EventBus.$on(\"updateGraph\", function (config) {\n      _this.container = document.getElementById(\"blitzboard\");\n      _this.config = config; // pg를 통해서 그래프 생성\n\n      _this.blitzboard.setGraph(_this.graph, false);\n\n      _this.blitzboard.setConfig(_this.config);\n\n      _this.registerClickEventonGraph();\n    });\n  },\n  mounted: function mounted() {},\n  methods: {\n    registerClickEventonGraph: function registerClickEventonGraph() {\n      var _this2 = this;\n\n      // 한번 클릭 시 해당 노드를 기준으로 쿼리\n      this.blitzboard.network.on(\"doubleClick\", function (e) {\n        if (e.nodes.length > 0) {\n          var node = _this2.blitzboard.nodeMap[e.nodes[0]];\n\n          _this2.blitzboard.scrollNodeIntoView(node); // 해당 노드를 하이라이트하여 중앙으로 이동시킴\n\n\n          _this2.queryByNodeId(node);\n        }\n      }); // 더블 클릭 시 속성값 가져오기\n\n      this.blitzboard.network.on(\"click\", function (e) {\n        if (e.nodes.length > 0) {\n          var node = _this2.blitzboard.nodeMap[e.nodes[0]];\n\n          _this2.$EventBus.$emit(\"nodeClicked\", node);\n        } // if (e.edges.length > 0) {\n        //   let edge = this.blitzboard.edgeMap[e.edges[0]];\n        //   //console.log(edge);\n        // }\n\n      });\n    },\n    queryByNodeId: function queryByNodeId(node) {\n      var _this3 = this;\n\n      var graph = this.graphItems.filter(function (it) {\n        return it.text.includes(node.labels[0]);\n      });\n      var query = '';\n      query += 'SELECT * FROM MATCH (n1)-[e]-(n2) ';\n      query += \"ON \" + graph[0].value + \" \"; //if(graph[0].value === 'G_NH_AGENT' || graph[0].value === 'G_NH_COMPANY' || graph[0].value === 'G_NH_EVENT') {\n      //  query += 'WHERE n1.id = \\'' + node.id + '\\' ';\n      //} else {\n\n      query += 'WHERE ID(n1) = \\'' + node.id + '\\' '; //}\n\n      if (this.formData.limit !== '') {\n        query += \"LIMIT \" + this.formData.limit;\n      }\n\n      console.log(query);\n      this.blitzboard.showLoader();\n      this.$axios({\n        method: \"get\",\n        url: \"/ui/v1/query?pgql=\" + encodeURI(query),\n        headers: {\n          \"Content-type\": \"application/json\"\n        },\n        withCredentials: true,\n        cossDomain: true\n      }).then(function (response) {\n        var result = response.data; // Nodes\n\n        result.graph.vertices.forEach(function (elem) {\n          var node = {\n            id: elem._id,\n            labels: elem.l,\n            properties: {}\n          };\n          elem.p.forEach(function (elem_p) {\n            if (elem_p.v) {\n              node.properties[elem_p.n] = [elem_p.v];\n            }\n          });\n\n          _this3.blitzboard.addNode(node, false);\n        }); // Edges\n\n        result.graph.edges.forEach(function (elem) {\n          // 여러번 클릭한 경우 동일한 엣지가 계속 생성되는 걸 방지...\n          //(!blitzboard.hasEdge(elem.s, elem.d)) {\n          var edge = {\n            id: elem._id,\n            from: elem.s,\n            to: elem.d,\n            labels: elem.l,\n            properties: {}\n          };\n          elem.p.forEach(function (elem_p) {\n            if (elem_p.v) {\n              edge.properties[elem_p.n] = [elem_p.v]; //edge.properties['weight'] = '5.77876';\n            }\n          });\n\n          _this3.blitzboard.addEdge(edge, false);\n        }); // Update\n\n        _this3.blitzboard.update();\n\n        _this3.blitzboard.hideLoader();\n      });\n    },\n    // by iron  \n    // redraw() query 를 받아서 그래프 구성  \n    redraw: function redraw() {\n      var _this4 = this;\n\n      //this.graph = this.inputpg;\n      var query = this.inputpg;\n      this.$axios({\n        method: \"get\",\n        url: \"/ui/v1/query?pgql=\" + encodeURI(query),\n        // + \"&graph=\" + this.formData.graph, \n        headers: {\n          \"Content-type\": \"application/json\"\n        },\n        withCredentials: true,\n        cossDomain: true\n      }).then(function (response) {\n        var nodes = [];\n        var edges = [];\n        var result = response.data;\n        result.graph.vertices.forEach(function (elem) {\n          var node = {\n            id: elem._id,\n            labels: elem.l,\n            properties: {}\n          };\n          elem.p.forEach(function (elem_p) {\n            if (elem_p.v) {\n              node.properties[elem_p.n] = [elem_p.v];\n            }\n          });\n          nodes.push(node);\n        });\n        result.graph.edges.forEach(function (elem) {\n          var edge = {\n            id: elem._id,\n            from: elem.s,\n            to: elem.d,\n            labels: elem.l,\n            properties: {}\n          };\n          elem.p.forEach(function (elem_p) {\n            if (elem_p.v) {\n              edge.properties[elem_p.n] = [elem_p.v];\n            }\n          });\n          edges.push(edge);\n        });\n        _this4.graphData = {\n          nodes: nodes,\n          edges: edges\n        };\n        console.log(_this4.graphData);\n\n        _this4.blitzboard.setGraph('');\n\n        _this4.blitzboard.setGraph(_this4.graphData, true);\n\n        _this4.blitzboard.setConfig(_this4.config);\n\n        _this4.registerClickEventonGraph();\n\n        _this4.dialog = !_this4.dialog;\n      });\n    },\n    reConfig: function reConfig() {\n      this.config = {\n        node: {\n          caption: [\"id\"],\n          defaultIcon: false,\n          icon: {\n            person: \"akar-icons:person\",\n            Property: \"f38f\",\n            Tax: \"f119\",\n            Account: \"f119\",\n            Income: \"f316\"\n          },\n          shape: {\n            person: \"triangle\",\n            graph: \"square\"\n          },\n          size: {\n            person: 10\n          }\n        },\n        edge: {\n          caption: [\"label\"],\n          color: {\n            say1: \"green\"\n          }\n        }\n      }; // pg를 통해서 그래프 생성\n\n      this.blitzboard.setGraph(this.graph, false);\n      this.blitzboard.setConfig(this.config);\n    }\n  }\n};","map":{"version":3,"mappings":"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","names":["name","data","container","blitzboard","config","graph","inputpg","dialog","graphData","graphItems","text","value","created","console","query","method","url","headers","withCredentials","cossDomain","then","result","id","labels","properties","elem","node","nodes","from","to","edge","edges","mounted","methods","registerClickEventonGraph","queryByNodeId","redraw","reConfig","caption","defaultIcon","icon","person","Property","Tax","Account","Income","shape","size","color","say1"],"sourceRoot":"src/views","sources":["Graph.vue"],"sourcesContent":["<template>\n  <v-main class=\"grey lighten-3\">\n    <v-container fluid>\n      <v-row>\n        <v-col class=\"pt-0 mt-0\">\n          <v-sheet min-height=\"78vh\" rounded=\"lg\">\n            <div style=\"height: 78vh; width: 98%;\" id=\"blitzboard\"></div>\n            <v-btn @click=\"dialog = !dialog\" color=\"#c83b29\" absolute fab large dark bottom right>\n              <v-icon>mdi-chevron-up</v-icon>\n            </v-btn>\n          </v-sheet>\n        </v-col>\n      </v-row>\n\n      <v-dialog v-model=\"dialog\" persistent max-width=\"500px\">\n        <v-card>\n          <v-card-title>\n            <span class=\"text-h5\">PG Query</span>\n          </v-card-title>\n          <v-card-text class=\"pa-0\">\n            <v-container fluid class=\"pa-2\">\n              <v-textarea outlined name=\"input-pg\" label=\"PG Query\" v-model=\"inputpg\" counter=\"6\"></v-textarea>\n            </v-container>\n          </v-card-text>\n          <v-card-actions>\n            <v-spacer></v-spacer>\n            <v-btn color=\"blue darken-1\" text @click=\"redraw\"> Submit </v-btn>\n            <v-btn color=\"blue darken-1\" text @click=\"dialog = false\">\n              Cancel\n            </v-btn>\n          </v-card-actions>\n        </v-card>\n      </v-dialog>\n    </v-container>\n  </v-main>\n</template>\n\n<script>\nexport default {\n  name: \"Graph\",\n\n  data: () => ({\n    container: null,\n    blitzboard: null,\n    config: null,\n    graph: null,\n    inputpg: \"\",\n    dialog: false,\n    graphData: null,\n    graphItems: [\n      { text: \"종목\", value: \"G_NH_STOCK\" },\n      { text: \"제품\", value: \"G_NH_PRODUCT\" },\n      { text: \"인물\", value: \"G_NH_PEOPLE\" },\n      { text: \"테마\", value: \"G_NH_THEME\" },\n      // by iron - 기관 회사 이벤트 추가\n      { text: \"기관\", value: \"G_NH_AGENT\" },\n      { text: \"회사\", value: \"G_NH_COMPANY\" },\n      { text: \"이벤트\", value: \"G_NH_EVENT\" },\n    ]\n  }),\n  created() {\n    this.$EventBus.$on(\"cleanGraph\", () => {\n      this.blitzboard.setGraph('');\n    });\n\n\n\n\n\n\n    this.$EventBus.$on(\"initGraph\", (config) => {\n      this.container = document.getElementById(\"blitzboard\");\n      this.blitzboard = new Blitzboard(this.container); // no-undef\n      this.config = config;\n\n      // pg를 통해서 그래프 생성\n      this.blitzboard.setGraph(\"\", false);\n      this.blitzboard.setConfig(this.config);\n\n      this.registerClickEventonGraph();\n\n    });\n\n    this.$EventBus.$on(\"querySubmit\", (formData) => {\n      console.log(formData);\n      this.formData = formData;\n      let query = '';\n\n      // Graph만\n      // -- by iron query 수정     \n      if (this.formData.searchTerm === '') {\n        query += \"SELECT * FROM MATCH (n1)-[e]-(n2) \";\n        query += \"ON \" + formData.graph + \" \";\n        //query += \"LIMIT 10\";\n      } else {\n        query += \"SELECT * FROM MATCH (n1)-[e]-(n2) \";\n        query += \"ON \" + formData.graph + \" \";\n        //query += \"WHERE n1.v_name = '\" + formData.searchTerm + \"' \";\n        query += \"WHERE JAVA_REGEXP_LIKE(n1.v_name, '\" + formData.searchTerm + \"') \"\n        //query += \"LIMIT \" + formData.limit;\n      }\n      if (this.formData.limit !== '') {\n        query += \"LIMIT \" + formData.limit;\n      }\n      console.log(query);\n\n      this.$axios({\n        method: \"get\",\n        url:\n          \"/ui/v1/query?pgql=\" + encodeURI(query),  // + \"&graph=\" + this.formData.graph,  -- by iron \n        headers: { \"Content-type\": \"application/json\" },\n        withCredentials: true,\n        cossDomain: true,\n      }).then((response) => {\n        var nodes = [];\n        var edges = [];\n        let result = response.data;\n\n        result.graph.vertices.forEach((elem) => {\n          let node = {\n            id: elem._id,\n            labels: elem.l,\n            properties: {},\n          };\n          elem.p.forEach((elem_p) => {\n            if (elem_p.v) {\n              node.properties[elem_p.n] = [elem_p.v];\n            }\n          });\n          nodes.push(node);\n        });\n\n        result.graph.edges.forEach((elem) => {\n          let edge = {\n            id: elem._id,\n            from: elem.s,\n            to: elem.d,\n            labels: elem.l,\n            properties: {},\n          };\n          elem.p.forEach((elem_p) => {\n            if (elem_p.v) {\n              edge.properties[elem_p.n] = [elem_p.v];\n            }\n          });\n\n          edges.push(edge);\n        });\n\n        this.graphData = { nodes: nodes, edges: edges };\n        console.log(this.graphData);\n        this.blitzboard.setGraph(this.graphData, true);\n        this.blitzboard.setConfig(this.config);\n\n        this.registerClickEventonGraph();\n      });\n    });\n\n    this.$EventBus.$on(\"updateGraph\", (config) => {\n      this.container = document.getElementById(\"blitzboard\");\n      this.config = config;\n\n      // pg를 통해서 그래프 생성\n      this.blitzboard.setGraph(this.graph, false);\n      this.blitzboard.setConfig(this.config);\n\n      this.registerClickEventonGraph();\n    });\n  },\n  mounted() {\n  },\n  methods: {\n    registerClickEventonGraph() {\n      // 한번 클릭 시 해당 노드를 기준으로 쿼리\n      this.blitzboard.network.on(\"doubleClick\", (e) => {\n        if (e.nodes.length > 0) {\n          let node = this.blitzboard.nodeMap[e.nodes[0]];\n\n          this.blitzboard.scrollNodeIntoView(node); // 해당 노드를 하이라이트하여 중앙으로 이동시킴\n\n          this.queryByNodeId(node);\n\n        }\n      });\n\n      // 더블 클릭 시 속성값 가져오기\n      this.blitzboard.network.on(\"click\", (e) => {\n        if (e.nodes.length > 0) {\n          let node = this.blitzboard.nodeMap[e.nodes[0]];\n          this.$EventBus.$emit(\"nodeClicked\", node);\n        }\n\n        // if (e.edges.length > 0) {\n        //   let edge = this.blitzboard.edgeMap[e.edges[0]];\n        //   //console.log(edge);\n        // }\n      });\n    },\n    queryByNodeId(node) {\n      let graph = this.graphItems.filter(it => it.text.includes(node.labels[0]));\n\n      let query = ''\n      query += 'SELECT * FROM MATCH (n1)-[e]-(n2) ';\n      query += \"ON \" + graph[0].value + \" \";\n\n      //if(graph[0].value === 'G_NH_AGENT' || graph[0].value === 'G_NH_COMPANY' || graph[0].value === 'G_NH_EVENT') {\n      //  query += 'WHERE n1.id = \\'' + node.id + '\\' ';\n      //} else {\n      query += 'WHERE ID(n1) = \\'' + node.id + '\\' ';\n      //}\n\n      if (this.formData.limit !== '') {\n        query += \"LIMIT \" + this.formData.limit;\n      }\n\n      console.log(query);\n\n      this.blitzboard.showLoader();\n\n      this.$axios({\n        method: \"get\",\n        url:\n          \"/ui/v1/query?pgql=\" + encodeURI(query),\n        headers: { \"Content-type\": \"application/json\" },\n        withCredentials: true,\n        cossDomain: true,\n      }).then((response) => {\n        let result = response.data;\n        // Nodes\n        result.graph.vertices.forEach((elem) => {\n          let node = {\n            id: elem._id,\n            labels: elem.l,\n            properties: {}\n          };\n          elem.p.forEach((elem_p) => {\n            if (elem_p.v) {\n              node.properties[elem_p.n] = [elem_p.v];\n            }\n          });\n          this.blitzboard.addNode(node, false);\n        });\n\n        // Edges\n        result.graph.edges.forEach((elem) => {\n\n          // 여러번 클릭한 경우 동일한 엣지가 계속 생성되는 걸 방지...\n          //(!blitzboard.hasEdge(elem.s, elem.d)) {\n\n          let edge = {\n            id: elem._id,\n            from: elem.s,\n            to: elem.d,\n            labels: elem.l,\n            properties: {}\n          };\n          elem.p.forEach((elem_p) => {\n            if (elem_p.v) {\n              edge.properties[elem_p.n] = [elem_p.v];\n              //edge.properties['weight'] = '5.77876';\n            }\n          });\n          this.blitzboard.addEdge(edge, false);\n        });\n        // Update\n        this.blitzboard.update();\n        this.blitzboard.hideLoader();\n\n      });\n    },\n\n    // by iron  \n    // redraw() query 를 받아서 그래프 구성  \n    redraw() {\n\n      //this.graph = this.inputpg;\n      let query = this.inputpg;\n\n      this.$axios({\n        method: \"get\",\n        url:\n          \"/ui/v1/query?pgql=\" + encodeURI(query),  // + \"&graph=\" + this.formData.graph, \n        headers: { \"Content-type\": \"application/json\" },\n        withCredentials: true,\n        cossDomain: true,\n      }).then((response) => {\n        var nodes = [];\n        var edges = [];\n        let result = response.data;\n\n        result.graph.vertices.forEach((elem) => {\n          let node = {\n            id: elem._id,\n            labels: elem.l,\n            properties: {},\n          };\n          elem.p.forEach((elem_p) => {\n            if (elem_p.v) {\n              node.properties[elem_p.n] = [elem_p.v];\n            }\n          });\n          nodes.push(node);\n        });\n\n        result.graph.edges.forEach((elem) => {\n          let edge = {\n            id: elem._id,\n            from: elem.s,\n            to: elem.d,\n            labels: elem.l,\n            properties: {},\n          };\n          elem.p.forEach((elem_p) => {\n            if (elem_p.v) {\n              edge.properties[elem_p.n] = [elem_p.v];\n            }\n          });\n\n          edges.push(edge);\n        });\n\n        this.graphData = { nodes: nodes, edges: edges };\n        console.log(this.graphData);\n        this.blitzboard.setGraph('')\n        this.blitzboard.setGraph(this.graphData, true);\n        this.blitzboard.setConfig(this.config);\n        this.registerClickEventonGraph();\n        this.dialog = !this.dialog;\n\n      });\n\n\n    },\n    reConfig() {\n      this.config = {\n        node: {\n          caption: [\"id\"],\n          defaultIcon: false,\n          icon: {\n            person: \"akar-icons:person\",\n            Property: \"f38f\",\n            Tax: \"f119\",\n            Account: \"f119\",\n            Income: \"f316\",\n          },\n          shape: {\n            person: \"triangle\",\n            graph: \"square\",\n          },\n          size: {\n            person: 10,\n          },\n        },\n        edge: {\n          caption: [\"label\"],\n          color: {\n            say1: \"green\",\n          },\n        },\n      };\n\n      // pg를 통해서 그래프 생성\n      this.blitzboard.setGraph(this.graph, false);\n      this.blitzboard.setConfig(this.config);\n    },\n  },\n};\n</script>\n"]},"metadata":{},"sourceType":"module"}